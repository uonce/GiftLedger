<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¶•ì˜ê¸ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ - ë‚˜ì˜ ë¶„ì„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            display: flex;
            height: 100vh;
        }

        .sidebar {
            width: 16.66%;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px 20px;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .sidebar-btn {
            padding: 18px 20px;
            background: white;
            border: 2px solid #667eea;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            color: #667eea;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .sidebar-btn:hover {
            background: #667eea;
            color: white;
            transform: translateX(5px);
        }

        .sidebar-btn.active {
            background: #667eea;
            color: white;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .header {
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .auth-buttons {
            display: flex;
            gap: 10px;
        }

        .auth-btn {
            padding: 10px 24px;
            border: 2px solid white;
            background: transparent;
            color: white;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .auth-btn:hover {
            background: white;
            color: #667eea;
        }

        .dashboard {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
        }

        .dashboard-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .card-header {
            margin-bottom: 30px;
        }

        .card-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
        }

        /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
        .tab-navigation {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }

        .tab-btn {
            padding: 12px 30px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px 10px 0 0;
            font-size: 15px;
            font-weight: 600;
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-btn:hover {
            border-color: #667eea;
            color: #667eea;
        }

        .tab-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
            transform: translateY(-2px);
        }

        /* íƒ­ ì»¨í…ì¸  */
        .tab-content {
            display: none;
            flex: 1;
            overflow-y: auto;
        }

        .tab-content.active {
            display: block;
        }

        /* ê³µí†µ ìŠ¤íƒ€ì¼ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-box {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .stat-box.primary {
            background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%);
        }

        .stat-box.success {
            background: linear-gradient(135deg, #55efc4 0%, #00b894 100%);
        }

        .stat-box.warning {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
        }

        .stat-box.danger {
            background: linear-gradient(135deg, #ff7675 0%, #d63031 100%);
        }

        .stat-box.info {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
        }

        .stat-label {
            font-size: 14px;
            font-weight: 600;
            color: #555;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 800;
            color: #333;
            margin-bottom: 5px;
        }

        .stat-detail {
            font-size: 12px;
            color: #666;
        }

        /* ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .list-container {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .list-header {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .list-item {
            background: white;
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .list-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .list-item-info {
            flex: 1;
        }

        .list-item-name {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .list-item-detail {
            font-size: 13px;
            color: #666;
        }

        .list-item-value {
            font-size: 18px;
            font-weight: 700;
            color: #667eea;
        }

        /* ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ */
        .chart-container {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 300px;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
        }

        /* ë¡œë”© ë° ì—ëŸ¬ */
        .loading {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-container {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 50px;
        }

        .error-message {
            color: #ff4757;
            text-align: center;
            padding: 20px;
            font-size: 16px;
        }

        .no-data {
            text-align: center;
            color: #999;
            padding: 40px;
            font-size: 16px;
        }

        /* ê²½ê³  ë°°ì§€ */
        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-danger {
            background: #ff7675;
            color: white;
        }

        .badge-warning {
            background: #fdcb6e;
            color: #333;
        }

        .badge-success {
            background: #00b894;
            color: white;
        }

        /* ì„¹ì…˜ êµ¬ë¶„ */
        .section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="sidebar">
        <button class="sidebar-btn" onclick="goToPage('index.html')">ì „ì²´ í†µê³„</button>
        <button class="sidebar-btn active" onclick="goToPage('analysis.html')">ë‚˜ì˜ ë¶„ì„</button>
        <button class="sidebar-btn" onclick="goToPage('event-register.html')">ì´ë²¤íŠ¸ ë“±ë¡</button>
        <button class="sidebar-btn" onclick="goToPage('event-search.html')">ì´ë²¤íŠ¸ ì¡°íšŒ</button>
    </div>

    <div class="main-content">
        <div class="header">
            <div class="logo">ì¶•ì˜ê¸ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ</div>
            <div class="auth-buttons" id="authButtons">
                <!-- ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼ ë™ì ìœ¼ë¡œ ë³€ê²½ -->
            </div>
        </div>

        <div class="dashboard">
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-title">ë‚˜ì˜ ì¶•ì˜ê¸ˆ ë¶„ì„</div>

                    <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
                    <div class="tab-navigation">
                        <button class="tab-btn active" onclick="changeTab('dashboard')">ğŸ“Š ì¢…í•© ëŒ€ì‹œë³´ë“œ</button>
                        <button class="tab-btn" onclick="changeTab('pattern')">ğŸ“ˆ ì§€ì¶œ íŒ¨í„´</button>
                        <button class="tab-btn" onclick="changeTab('relation')">ğŸ‘¥ ì§€ì¸ ë¶„ì„</button>
                        <button class="tab-btn" onclick="changeTab('recovery')">ğŸ’° íšŒìˆ˜ìœ¨</button>
                    </div>
                </div>

                <!-- íƒ­ 1: ì¢…í•© ëŒ€ì‹œë³´ë“œ -->
                <div id="tab-dashboard" class="tab-content active">
                    <div class="stats-grid">
                        <div class="stat-box primary">
                            <div class="stat-label">ì´ ì¤€ ê¸ˆì•¡</div>
                            <div class="stat-value" id="totalGive">0ì›</div>
                        </div>
                        <div class="stat-box success">
                            <div class="stat-label">ì´ ë°›ì€ ê¸ˆì•¡</div>
                            <div class="stat-value" id="totalTake">0ì›</div>
                        </div>
                        <div class="stat-box warning">
                            <div class="stat-label">ì”ì•¡</div>
                            <div class="stat-value" id="balance">0ì›</div>
                        </div>
                        <div class="stat-box info">
                            <div class="stat-label">íšŒìˆ˜ìœ¨</div>
                            <div class="stat-value" id="recoveryRate">0%</div>
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-title">ì „ë…„ ëŒ€ë¹„ ë³€í™”</div>
                        <div class="stats-grid">
                            <div class="stat-box">
                                <div class="stat-label">ì „ë…„ ëŒ€ë¹„ ì§€ì¶œ</div>
                                <div class="stat-value" id="yearChange">-</div>
                                <div class="stat-detail" id="yearChangeDetail">-</div>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-title">ìµœê·¼ ì´ë²¤íŠ¸</div>
                        <div class="list-container" id="recentEvents">
                            <div class="loading-container">
                                <div class="loading"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- íƒ­ 2: ì§€ì¶œ íŒ¨í„´ ë¶„ì„ -->
                <div id="tab-pattern" class="tab-content">
                    <div class="section">
                        <div class="section-title">ì›”ë³„ ì§€ì¶œ ê·¸ë˜í”„</div>
                        <div class="chart-container" id="monthlyChart">
                            <div class="loading-container">
                                <div class="loading"></div>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-title">ìš”ì¼ë³„ ì§€ì¶œ ê·¸ë˜í”„</div>
                        <div class="chart-container" id="weekdayChart">
                            <div class="loading-container">
                                <div class="loading"></div>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-title">ì´ë²¤íŠ¸ë³„ ë¶„í¬</div>
                        <div class="stats-grid" id="eventDistribution">
                            <div class="loading-container">
                                <div class="loading"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- íƒ­ 3: ì§€ì¸ ë¶„ì„ -->
                <div id="tab-relation" class="tab-content">
                    <div class="section">
                        <div class="section-title">TOP 5 ì§€ì¸</div>
                        <div class="list-container" id="topRelations">
                            <div class="loading-container">
                                <div class="loading"></div>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-title">ì§€ì¸ë³„ íšŒìˆ˜ìœ¨</div>
                        <div class="list-container" id="relationRecovery">
                            <div class="loading-container">
                                <div class="loading"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- íƒ­ 4: íšŒìˆ˜ìœ¨ ëŒ€ì‹œë³´ë“œ -->
                <div id="tab-recovery" class="tab-content">
                    <div class="stats-grid">
                        <div class="stat-box success">
                            <div class="stat-label">ì „ì²´ íšŒìˆ˜ìœ¨</div>
                            <div class="stat-value" id="totalRecovery">0%</div>
                        </div>
                        <div class="stat-box danger">
                            <div class="stat-label">ë¯¸íšŒìˆ˜ ê¸ˆì•¡</div>
                            <div class="stat-value" id="unrecovered">0ì›</div>
                        </div>
                        <div class="stat-box warning">
                            <div class="stat-label">ì˜ˆìƒ íšŒìˆ˜ ê¸ˆì•¡</div>
                            <div class="stat-value" id="expectedRecovery">0ì›</div>
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-title">ë¯¸íšŒìˆ˜ ì§€ì¸ ë¦¬ìŠ¤íŠ¸</div>
                        <div class="list-container" id="unrecoveredList">
                            <div class="loading-container">
                                <div class="loading"></div>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-title">ì¥ê¸° ë¯¸íšŒìˆ˜ ê²½ê³ </div>
                        <div class="list-container" id="longTermWarning">
                            <div class="loading-container">
                                <div class="loading"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const API_BASE_URL = 'http://localhost:8080';
    let currentTab = 'dashboard';

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
    window.onload = function() {
        checkLoginStatus();
        loadDashboardData();
    };

    // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
    function checkLoginStatus() {
        const token = localStorage.getItem('accessToken');
        console.log('í˜„ì¬ í† í°:', token);
        const authButtons = document.getElementById('authButtons');

        if (!token) {
            // ë¡œê·¸ì¸ë˜ì§€ ì•Šì€ ê²½ìš° ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
            alert('ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.');
            window.location.href = 'login.html';
            return;
        }

        // ë¡œê·¸ì¸ ìƒíƒœ â†’ ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ë§Œ ë³´ì—¬ì£¼ê¸°
        authButtons.innerHTML = `
            <button class="auth-btn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
        `;
    }

    // ë¡œê·¸ì•„ì›ƒ
    function logout() {
        localStorage.removeItem('accessToken');
        alert('ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.');
        window.location.href = 'index.html';
    }

    // íƒ­ ë³€ê²½
    function changeTab(tabName) {
        currentTab = tabName;

        // ëª¨ë“  íƒ­ ë²„íŠ¼ê³¼ ì»¨í…ì¸  ë¹„í™œì„±í™”
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

        // ì„ íƒëœ íƒ­ í™œì„±í™”
        event.target.classList.add('active');
        document.getElementById(`tab-${tabName}`).classList.add('active');

        // í•´ë‹¹ íƒ­ ë°ì´í„° ë¡œë“œ
        loadTabData(tabName);
    }

    // íƒ­ë³„ ë°ì´í„° ë¡œë“œ
    function loadTabData(tabName) {
        switch(tabName) {
            case 'dashboard':
                loadDashboardData();
                break;
            case 'pattern':
                loadPatternData();
                break;
            case 'relation':
                loadRelationData();
                break;
            case 'recovery':
                loadRecoveryData();
                break;
        }
    }

    // 1. ì¢…í•© ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ
    async function loadDashboardData() {
        const token = localStorage.getItem('accessToken');

        try {
            // API í˜¸ì¶œ ì˜ˆì‹œ (ì‹¤ì œ API ì—”ë“œí¬ì¸íŠ¸ì— ë§ê²Œ ìˆ˜ì • í•„ìš”)
            const response = await fetch(`${API_BASE_URL}/api/my-statistics/dashboard`, {
                headers: {
                    'Authorization': `Bearer ${token}`
                }
            });

            if (!response.ok) {
                throw new Error('Failed to fetch dashboard data');
            }

            const data = await response.json();

            // ë°ì´í„° í‘œì‹œ
            document.getElementById('totalGive').textContent = data.totalGive.toLocaleString() + 'ì›';
            document.getElementById('totalTake').textContent = data.totalTake.toLocaleString() + 'ì›';
            document.getElementById('balance').textContent = (data.totalTake - data.totalGive).toLocaleString() + 'ì›';
            document.getElementById('recoveryRate').textContent = data.recoveryRate + '%';

            // ì „ë…„ ëŒ€ë¹„ ë³€í™”
            const changePercent = data.yearChangePercent > 0 ? '+' + data.yearChangePercent : data.yearChangePercent;
            document.getElementById('yearChange').textContent = changePercent + '%';
            document.getElementById('yearChangeDetail').textContent = data.yearChangeAmount.toLocaleString() + 'ì›';

            // ìµœê·¼ ì´ë²¤íŠ¸
            displayRecentEvents(data.recentEvents);

        } catch (error) {
            console.error('Error loading dashboard:', error);
            // ì„ì‹œ ë°ëª¨ ë°ì´í„° í‘œì‹œ
            displayDemoDashboard();
        }
    }

    // ì„ì‹œ ë°ëª¨ ë°ì´í„° í‘œì‹œ
    function displayDemoDashboard() {
        document.getElementById('totalGive').textContent = '1,500,000ì›';
        document.getElementById('totalTake').textContent = '1,200,000ì›';
        document.getElementById('balance').textContent = '-300,000ì›';
        document.getElementById('recoveryRate').textContent = '80%';
        document.getElementById('yearChange').textContent = '+15%';
        document.getElementById('yearChangeDetail').textContent = '+200,000ì›';

        // ìµœê·¼ ì´ë²¤íŠ¸ ë°ëª¨ ë°ì´í„°
        const demoEvents = [
            { name: 'ê¹€ì² ìˆ˜', eventType: 'ê²°í˜¼ì‹', amount: 100000, date: '2024-12-10', type: 'GIVE' },
            { name: 'ì´ì˜í¬', eventType: 'ìƒì¼', amount: 50000, date: '2024-12-08', type: 'TAKE' },
            { name: 'ë°•ë¯¼ìˆ˜', eventType: 'ì¥ë¡€ì‹', amount: 200000, date: '2024-12-05', type: 'GIVE' },
            { name: 'ìµœì§€ì€', eventType: 'ê²°í˜¼ì‹', amount: 150000, date: '2024-12-03', type: 'TAKE' },
            { name: 'ì •ëŒ€í•œ', eventType: 'ìƒì¼', amount: 30000, date: '2024-12-01', type: 'GIVE' }
        ];
        displayRecentEvents(demoEvents);
    }

    // ìµœê·¼ ì´ë²¤íŠ¸ í‘œì‹œ
    function displayRecentEvents(events) {
        const container = document.getElementById('recentEvents');

        if (!events || events.length === 0) {
            container.innerHTML = '<div class="no-data">ìµœê·¼ ì´ë²¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
            return;
        }

        let html = '';
        events.forEach(event => {
            const typeText = event.type === 'GIVE' ? 'ì§€ì¶œ' : 'ìˆ˜ì…';
            const typeColor = event.type === 'GIVE' ? '#ff7675' : '#00b894';
            html += `
                <div class="list-item">
                    <div class="list-item-info">
                        <div class="list-item-name">${event.name}</div>
                        <div class="list-item-detail">${event.eventType} Â· ${event.date} Â· ${typeText}</div>
                    </div>
                    <div class="list-item-value" style="color: ${typeColor}">
                        ${event.amount.toLocaleString()}ì›
                    </div>
                </div>
            `;
        });
        container.innerHTML = html;
    }

    // 2. ì§€ì¶œ íŒ¨í„´ ë°ì´í„° ë¡œë“œ
    async function loadPatternData() {
        // TODO: API ì—°ë™
        displayDemoPattern();
    }

    function displayDemoPattern() {
        // ì›”ë³„ ì°¨íŠ¸
        document.getElementById('monthlyChart').innerHTML = `
            <div class="chart-title">ì›”ë³„ ì§€ì¶œ ì¶”ì´</div>
            <div class="no-data">ì°¨íŠ¸ ë°ì´í„°ë¥¼ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.</div>
        `;

        // ìš”ì¼ë³„ ì°¨íŠ¸
        document.getElementById('weekdayChart').innerHTML = `
            <div class="chart-title">ìš”ì¼ë³„ ì§€ì¶œ íŒ¨í„´</div>
            <div class="no-data">ì°¨íŠ¸ ë°ì´í„°ë¥¼ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.</div>
        `;

        // ì´ë²¤íŠ¸ë³„ ë¶„í¬
        const eventTypes = [
            { type: 'ê²°í˜¼ì‹', count: 15, amount: 1500000 },
            { type: 'ì¥ë¡€ì‹', count: 8, amount: 800000 },
            { type: 'ìƒì¼', count: 12, amount: 360000 },
            { type: 'ê¸°íƒ€', count: 5, amount: 250000 }
        ];

        let html = '';
        eventTypes.forEach(event => {
            html += `
                <div class="stat-box">
                    <div class="stat-label">${event.type}</div>
                    <div class="stat-value">${event.count}ê±´</div>
                    <div class="stat-detail">${event.amount.toLocaleString()}ì›</div>
                </div>
            `;
        });
        document.getElementById('eventDistribution').innerHTML = html;
    }

    // 3. ì§€ì¸ ë¶„ì„ ë°ì´í„° ë¡œë“œ
    async function loadRelationData() {
        // TODO: API ì—°ë™
        displayDemoRelation();
    }

    function displayDemoRelation() {
        // TOP 5 ì§€ì¸
        const topRelations = [
            { name: 'ê¹€ì² ìˆ˜', totalAmount: 500000, eventCount: 5, avgAmount: 100000 },
            { name: 'ì´ì˜í¬', totalAmount: 400000, eventCount: 4, avgAmount: 100000 },
            { name: 'ë°•ë¯¼ìˆ˜', totalAmount: 350000, eventCount: 3, avgAmount: 116667 },
            { name: 'ìµœì§€ì€', totalAmount: 300000, eventCount: 3, avgAmount: 100000 },
            { name: 'ì •ëŒ€í•œ', totalAmount: 250000, eventCount: 2, avgAmount: 125000 }
        ];

        let html = '';
        topRelations.forEach((rel, index) => {
            html += `
                <div class="list-item">
                    <div class="list-item-info">
                        <div class="list-item-name">${index + 1}. ${rel.name}</div>
                        <div class="list-item-detail">${rel.eventCount}ê±´ Â· í‰ê·  ${rel.avgAmount.toLocaleString()}ì›</div>
                    </div>
                    <div class="list-item-value">${rel.totalAmount.toLocaleString()}ì›</div>
                </div>
            `;
        });
        document.getElementById('topRelations').innerHTML = html;

        // ì§€ì¸ë³„ íšŒìˆ˜ìœ¨
        const recoveryData = [
            { name: 'ê¹€ì² ìˆ˜', give: 300000, take: 250000, rate: 83 },
            { name: 'ì´ì˜í¬', give: 200000, take: 200000, rate: 100 },
            { name: 'ë°•ë¯¼ìˆ˜', give: 150000, take: 100000, rate: 67 },
            { name: 'ìµœì§€ì€', give: 100000, take: 0, rate: 0 }
        ];

        html = '';
        recoveryData.forEach(rel => {
            const badgeClass = rel.rate >= 80 ? 'badge-success' : rel.rate >= 50 ? 'badge-warning' : 'badge-danger';
            html += `
                <div class="list-item">
                    <div class="list-item-info">
                        <div class="list-item-name">${rel.name} <span class="badge ${badgeClass}">${rel.rate}%</span></div>
                        <div class="list-item-detail">ì¤€ ê¸ˆì•¡: ${rel.give.toLocaleString()}ì› / ë°›ì€ ê¸ˆì•¡: ${rel.take.toLocaleString()}ì›</div>
                    </div>
                </div>
            `;
        });
        document.getElementById('relationRecovery').innerHTML = html;
    }

    // 4. íšŒìˆ˜ìœ¨ ë°ì´í„° ë¡œë“œ
    async function loadRecoveryData() {
        // TODO: API ì—°ë™
        displayDemoRecovery();
    }

    function displayDemoRecovery() {
        document.getElementById('totalRecovery').textContent = '75%';
        document.getElementById('unrecovered').textContent = '500,000ì›';
        document.getElementById('expectedRecovery').textContent = '300,000ì›';

        // ë¯¸íšŒìˆ˜ ì§€ì¸ ë¦¬ìŠ¤íŠ¸
        const unrecoveredList = [
            { name: 'ìµœì§€ì€', amount: 200000, date: '2024-06-15', days: 180 },
            { name: 'ê°•ë¯¼í˜¸', amount: 150000, date: '2024-08-20', days: 113 },
            { name: 'ìœ¤ì„œì•„', amount: 100000, date: '2024-10-01', days: 71 },
            { name: 'ì„ë™ì£¼', amount: 50000, date: '2024-11-10', days: 31 }
        ];

        let html = '';
        unrecoveredList.forEach(rel => {
            const badgeClass = rel.days >= 180 ? 'badge-danger' : rel.days >= 90 ? 'badge-warning' : '';
            html += `
                <div class="list-item">
                    <div class="list-item-info">
                        <div class="list-item-name">
                            ${rel.name}
                            ${badgeClass ? `<span class="badge ${badgeClass}">${rel.days}ì¼ ê²½ê³¼</span>` : ''}
                        </div>
                        <div class="list-item-detail">${rel.date} ì§€ì¶œ</div>
                    </div>
                    <div class="list-item-value">${rel.amount.toLocaleString()}ì›</div>
                </div>
            `;
        });
        document.getElementById('unrecoveredList').innerHTML = html;

        // ì¥ê¸° ë¯¸íšŒìˆ˜ ê²½ê³ 
        const longTermList = unrecoveredList.filter(rel => rel.days >= 180);

        if (longTermList.length === 0) {
            document.getElementById('longTermWarning').innerHTML = '<div class="no-data">ì¥ê¸° ë¯¸íšŒìˆ˜ ê±´ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
        } else {
            html = '';
            longTermList.forEach(rel => {
                html += `
                    <div class="list-item">
                        <div class="list-item-info">
                            <div class="list-item-name">${rel.name} <span class="badge badge-danger">ê²½ê³ </span></div>
                            <div class="list-item-detail">${rel.days}ì¼ ë™ì•ˆ ë¯¸íšŒìˆ˜ (${rel.date})</div>
                        </div>
                        <div class="list-item-value">${rel.amount.toLocaleString()}ì›</div>
                    </div>
                `;
            });
            document.getElementById('longTermWarning').innerHTML = html;
        }
    }

    // í˜ì´ì§€ ì´ë™
    function goToPage(page) {
        window.location.href = page;
    }
</script>
</body>
</html>